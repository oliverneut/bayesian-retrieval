#!/bin/sh
#SBATCH -o ./output/logs/%A.out
#SBATCH -e ./output/logs/%A.err
#SBATCH --partition=gpu
#SBATCH --gpus-per-node=1
#SBATCH --time=72:00:00
# Set-up the environment.
source ${HOME}/.bashrc
# Activate env.
conda activate bret

CUDA_VISIBLE_DEVICES=0 python src/bret/scripts/eval_msmarco.py \
    --msmarco_dir data/msmarco \
    --split dev \
    --query_file data/msmarco-dev.jsonl \
    --corpus_file data/msmarco-corpus.jsonl \
    --model_name bert-tiny \
    --encoder_ckpt output/trained_encoders/bert-tiny-vi.pt \
    --method vi \
    --num_samples 10\
    --max_qry_len 32 \
    --k 20 \
    --embeddings_dir output/embeddings \
    --output_dir output/results
